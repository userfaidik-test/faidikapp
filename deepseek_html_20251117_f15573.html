<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FaidikApp</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2a 50%, #0a0a0a 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(76, 175, 80, 0.3);
            border-top: 4px solid #4CAF50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .header {
            width: 100%;
            background: rgba(17, 17, 17, 0.8);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 25px;
            border-bottom: 1px solid rgba(51, 51, 51, 0.5);
        }
        
        .logo {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 25px;
            flex: 1;
        }
        
        .search-section {
            background: rgba(17, 17, 17, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 30px;
            border: 1px solid rgba(51, 51, 51, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .search-input {
            padding: 18px;
            font-size: 1.1rem;
            background: rgba(34, 34, 34, 0.8);
            border: 1px solid rgba(68, 68, 68, 0.5);
            border-radius: 12px;
            color: #fff;
            outline: none;
            width: 100%;
            transition: all 0.3s;
        }
        
        .search-input:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.3);
            background: rgba(34, 34, 34, 0.9);
        }
        
        .search-type {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .search-type-btn {
            padding: 14px;
            background: rgba(34, 34, 34, 0.8);
            border: 1px solid rgba(68, 68, 68, 0.5);
            border-radius: 12px;
            color: #aaa;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .search-type-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            background: rgba(51, 51, 51, 0.8);
        }
        
        .search-type-btn.active {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: #fff;
            border-color: #4CAF50;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }
        
        .settings-panel {
            background: rgba(34, 34, 34, 0.6);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(68, 68, 68, 0.3);
            display: none;
        }
        
        .settings-panel.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .setting-label {
            color: #ccc;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .setting-select, .setting-input {
            padding: 12px;
            background: rgba(51, 51, 51, 0.8);
            border: 1px solid rgba(68, 68, 68, 0.5);
            border-radius: 8px;
            color: #fff;
            font-size: 0.9rem;
            outline: none;
            transition: all 0.3s;
        }
        
        .setting-select:focus, .setting-input:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
        
        .search-btn {
            padding: 18px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border: none;
            border-radius: 12px;
            color: #fff;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            font-weight: bold;
            margin-bottom: 15px;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(76, 175, 80, 0.5);
        }
        
        .search-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(51, 51, 51, 0.5);
            border-radius: 3px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            width: 0%;
            transition: width 0.4s;
            border-radius: 3px;
        }

        .api-counter {
            text-align: center;
            color: #888;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .results {
            margin-top: 25px;
        }
        
        .result-item {
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(51, 51, 51, 0.3);
            transition: all 0.3s;
            background: rgba(34, 34, 34, 0.6);
            backdrop-filter: blur(10px);
        }
        
        .result-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .valid {
            background: rgba(26, 60, 26, 0.6);
            color: #4CAF50;
            border-color: rgba(46, 125, 50, 0.5);
        }
        
        .invalid {
            background: rgba(60, 26, 26, 0.6);
            color: #F44336;
            border-color: rgba(198, 40, 40, 0.5);
        }
        
        .error {
            background: rgba(60, 60, 26, 0.6);
            color: #FFC107;
            border-color: rgba(255, 143, 0, 0.5);
        }
        
        .checking {
            background: rgba(42, 42, 42, 0.6);
            color: #aaa;
        }
        
        .service-name {
            font-size: 0.9rem;
            color: #ccc;
            font-weight: normal;
        }
        
        .status {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .footer {
            background: rgba(17, 17, 17, 0.8);
            backdrop-filter: blur(20px);
            padding: 25px 0;
            text-align: center;
            margin-top: 40px;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid rgba(51, 51, 51, 0.5);
        }
        
        .total-result {
            text-align: center;
            padding: 25px;
            margin-top: 25px;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: bold;
            display: none;
            backdrop-filter: blur(10px);
        }
        
        .total-valid {
            background: rgba(26, 60, 26, 0.6);
            color: #4CAF50;
            border: 1px solid rgba(46, 125, 50, 0.5);
        }
        
        .total-invalid {
            background: rgba(60, 26, 26, 0.6);
            color: #F44336;
            border: 1px solid rgba(198, 40, 40, 0.5);
        }
        
        .api-result {
            background: rgba(26, 26, 60, 0.6);
            color: #fff;
            border: 1px solid rgba(51, 51, 51, 0.3);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
        }
        
        .result-data {
            margin-top: 15px;
            padding: 15px;
            background: rgba(42, 42, 74, 0.6);
            border-radius: 12px;
            border: 1px solid rgba(68, 68, 68, 0.3);
        }
        
        .info-line {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px 0;
            border-bottom: 1px solid rgba(68, 68, 68, 0.3);
        }
        
        .info-label {
            color: #aaa;
            font-weight: 500;
        }
        
        .info-value {
            color: #fff;
            font-weight: bold;
        }

        .section-title {
            color: #4CAF50;
            margin: 15px 0 10px 0;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .json-container {
            background: rgba(26, 26, 42, 0.6);
            border-radius: 12px;
            padding: 15px;
            margin: 10px 0;
            border: 1px solid rgba(68, 68, 68, 0.3);
            max-height: 400px;
            overflow-y: auto;
        }

        .json-item {
            background: rgba(42, 42, 58, 0.6);
            border-radius: 10px;
            padding: 12px;
            margin: 8px 0;
            border-left: 4px solid #4CAF50;
        }

        .json-field {
            display: flex;
            margin: 4px 0;
            padding: 2px 0;
        }

        .json-key {
            color: #4CAF50;
            font-weight: bold;
            min-width: 120px;
        }

        .json-value {
            color: #fff;
            flex: 1;
        }

        .database-badge {
            background: #FF9800;
            color: #000;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
        }

        .leak-item {
            background: rgba(58, 26, 26, 0.6);
            border-left: 4px solid #F44336;
        }

        .social-item {
            background: rgba(26, 58, 58, 0.6);
            border-left: 4px solid #00BCD4;
        }

        .finance-item {
            background: rgba(42, 58, 26, 0.6);
            border-left: 4px solid #8BC34A;
        }

        .personal-item {
            background: rgba(58, 26, 58, 0.6);
            border-left: 4px solid #9C27B0;
        }

        .technical-item {
            background: rgba(26, 58, 58, 0.6);
            border-left: 4px solid #2196F3;
        }

        .floating-bg {
            position: fixed;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(76, 175, 80, 0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
            z-index: -1;
        }

        .float-1 {
            top: 10%;
            left: 5%;
            animation-delay: 0s;
        }

        .float-2 {
            top: 60%;
            right: 10%;
            animation-delay: 2s;
        }

        .float-3 {
            bottom: 20%;
            left: 20%;
            animation-delay: 4s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .input-examples {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .example-btn {
            padding: 6px 12px;
            background: rgba(51, 51, 51, 0.6);
            border: 1px solid rgba(68, 68, 68, 0.5);
            border-radius: 6px;
            color: #ccc;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .example-btn:hover {
            background: rgba(76, 175, 80, 0.3);
            color: #fff;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .search-section {
                padding: 25px;
            }
            
            .search-type {
                grid-template-columns: 1fr;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .json-field {
                flex-direction: column;
            }
            
            .json-key {
                min-width: auto;
                margin-bottom: 4px;
            }
        }
    </style>
</head>
<body>
    <div class="loader" id="loader">
        <div class="spinner"></div>
    </div>

    <div class="floating-bg float-1"></div>
    <div class="floating-bg float-2"></div>
    <div class="floating-bg float-3"></div>

    <div class="header">
        <div class="logo">FaidikApp</div>
    </div>
    
    <div class="container">
        <div class="search-section">
            <div class="input-group">
                <input type="text" class="search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, email, –§–ò–û, –Ω–∏–∫–Ω–µ–π–º, VK ID, –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä, IP, –°–ù–ò–õ–°, –ò–ù–ù, –ø–∞—Å–ø–æ—Ä—Ç, –∞–¥—Ä–µ—Å..." id="searchInput">
                
                <div class="input-examples">
                    <div class="example-btn" data-example="+79161234567">–¢–µ–ª–µ—Ñ–æ–Ω</div>
                    <div class="example-btn" data-example="example@mail.ru">Email</div>
                    <div class="example-btn" data-example="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">–§–ò–û</div>
                    <div class="example-btn" data-example="username">–ù–∏–∫–Ω–µ–π–º</div>
                    <div class="example-btn" data-example="id123456789">VK ID</div>
                    <div class="example-btn" data-example="–ê123–ë–í77">–ê–≤—Ç–æ–Ω–æ–º–µ—Ä</div>
                    <div class="example-btn" data-example="192.168.1.1">IP</div>
                    <div class="example-btn" data-example="123-456-789 01">–°–ù–ò–õ–°</div>
                </div>
                
                <div class="search-type">
                    <button class="search-type-btn active" data-type="validity">–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏</button>
                    <button class="search-type-btn" data-type="api">–ü–æ–∏—Å–∫ –ø–æ ATLAS API</button>
                    <button class="search-type-btn" data-type="deep">–ì–ª—É–±–æ–∫–∏–π –ø–æ–∏—Å–∫</button>
                </div>
                
                <div class="settings-panel" id="apiSettings">
                    <div class="settings-grid">
                        <div class="setting-group">
                            <label class="setting-label">–¢–∏–ø –ø–æ–∏—Å–∫–∞:</label>
                            <select class="setting-select" id="searchType">
                                <option value="auto">–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</option>
                                <option value="phone">–¢–µ–ª–µ—Ñ–æ–Ω</option>
                                <option value="email">Email</option>
                                <option value="fio">–§–ò–û</option>
                                <option value="vk">–í–ö–æ–Ω—Ç–∞–∫—Ç–µ</option>
                                <option value="auto">–ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä</option>
                                <option value="nick">–ù–∏–∫–Ω–µ–π–º</option>
                                <option value="snils">–°–ù–ò–õ–°</option>
                                <option value="inn">–ò–ù–ù</option>
                                <option value="ip">IP-–∞–¥—Ä–µ—Å</option>
                                <option value="passport">–ü–∞—Å–ø–æ—Ä—Ç</option>
                                <option value="address">–ê–¥—Ä–µ—Å</option>
                                <option value="vin">VIN –∞–≤—Ç–æ</option>
                            </select>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-label">–ú–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞:</label>
                            <select class="setting-select" id="searchMethod">
                                <option value="lite">Lite (40–¢–ë –±–∞–∑–∞)</option>
                                <option value="pro">Pro (100–¢–ë –±–∞–∑–∞)</option>
                                <option value="full">Full (200–¢–ë –±–∞–∑–∞)</option>
                                <option value="ultimate">Ultimate (500–¢–ë –±–∞–∑–∞)</option>
                            </select>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-label">–ì–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞:</label>
                            <select class="setting-select" id="searchDepth">
                                <option value="basic">–ë–∞–∑–æ–≤–∞—è</option>
                                <option value="extended">–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è</option>
                                <option value="deep">–ì–ª—É–±–æ–∫–∞—è</option>
                                <option value="maximum">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è</option>
                            </select>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-label">–í–∫–ª—é—á–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏:</label>
                            <select class="setting-select" id="dataSources" multiple>
                                <option value="social" selected>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</option>
                                <option value="leaks" selected>–£—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö</option>
                                <option value="finance">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</option>
                                <option value="government">–ì–æ—Å. –±–∞–∑—ã</option>
                                <option value="commercial">–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –±–∞–∑—ã</option>
                                <option value="darknet">Darknet –∏—Å—Ç–æ—á–Ω–∏–∫–∏</option>
                                <option value="telegram">Telegram –¥–∞–Ω–Ω—ã–µ</option>
                                <option value="forums">–§–æ—Ä—É–º—ã –∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="settings-grid">
                        <div class="setting-group">
                            <label class="setting-label">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:</label>
                            <select class="setting-select" id="outputFormat">
                                <option value="structured">–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π</option>
                                <option value="raw">–°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ</option>
                                <option value="minimal">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π</option>
                                <option value="detailed">–î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π</option>
                            </select>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-label">–õ–∏–º–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:</label>
                            <input type="number" class="setting-input" id="resultLimit" value="100" min="1" max="5000">
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-label">–¢–∞–π–º–∞—É—Ç (—Å–µ–∫):</label>
                            <input type="number" class="setting-input" id="timeout" value="45" min="5" max="300">
                        </div>
                    </div>
                </div>
                
                <button class="search-btn" id="searchBtn">–ù–ê–ß–ê–¢–¨ –ü–û–ò–°–ö</button>
                
                <div class="progress-bar">
                    <div class="progress" id="progressBar"></div>
                </div>
                
                <div class="api-counter" id="apiCounter"></div>
            </div>
            
            <div class="results" id="results">
            </div>
            
            <div class="total-result" id="totalResult"></div>
        </div>
    </div>
    
    <div class="footer">
        <p>ATLAS API ‚Ä¢ FaidikSearch.xyz</p>
    </div>

    <script>
        let currentSearchType = 'validity';
        let currentSearchInProgress = false;
        let sessionId = generateSessionId();

        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        // üîÑ –í–°–ï –§–£–ù–ö–¶–ò–ò –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø –¢–ï–ü–ï–†–¨ –ß–ï–†–ï–ó API
        async function logAction(action, data = null, level = 'info') {
            try {
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                const ip = ipData.ip;
                
                const timestamp = new Date().toLocaleString('ru-RU');
                const userAgent = navigator.userAgent;
                const screenResolution = `${screen.width}x${screen.height}`;
                
                let message = `üîç SEARCH_SYSTEM\n`;
                message += `üÜî Session: ${sessionId}\n`;
                message += `üåê IP: ${ip}\n`;
                message += `üïí Time: ${timestamp}\n`;
                message += `üì± UserAgent: ${userAgent}\n`;
                message += `üì∫ Screen: ${screenResolution}\n`;
                message += `‚ö° Action: ${action}\n`;
                message += `üìä Level: ${level.toUpperCase()}\n`;
                
                if (data) {
                    if (typeof data === 'object') {
                        message += `üì¶ Data: ${JSON.stringify(data, null, 2)}\n`;
                    } else {
                        message += `üì¶ Data: ${data}\n`;
                    }
                }

                message += `üîö End of log`;

                // –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ –Ω–∞—à API
                await fetch('/api/search', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'log',
                        query: message
                    })
                });
            } catch (error) {
                console.error('–°–∏—Å—Ç–µ–º–Ω–∞—è –æ—à–∏–±–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:', error);
            }
        }

        async function logError(error, context = '') {
            const errorData = {
                name: error.name,
                message: error.message,
                stack: error.stack,
                context: context,
                sessionId: sessionId,
                url: window.location.href,
                timestamp: new Date().toISOString()
            };
            
            await logAction(`ERROR: ${error.name}`, errorData, 'error');
        }

        // üîÑ ATLAS API –¢–ï–ü–ï–†–¨ –ß–ï–†–ï–ó –ù–ê–® –°–ï–†–í–ï–†
        async function searchAtlasAPI(query, settings) {
            const response = await fetch('/api/search', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    action: 'search',
                    query: query,
                    settings: settings
                })
            });
            
            if (!response.ok) {
                throw new Error(`API error: ${response.status}`);
            }
            
            return await response.json();
        }

        function detectSearchType(query) {
            const cleanQuery = query.trim();
            
            if (/^\+?[78][-\s]?\(?\d{3}\)?[-\s]?\d{3}[-\s]?\d{2}[-\s]?\d{2}$/.test(cleanQuery) || 
                /^\+?[1-9]\d{1,14}$/.test(cleanQuery.replace(/\D/g, ''))) {
                return 'phone';
            }
            
            if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(cleanQuery)) {
                return 'email';
            }
            
            if (/^(id\d+|vk\.com\/[a-zA-Z0-9_.]+)$/.test(cleanQuery) || 
                cleanQuery.includes('vk.com')) {
                return 'vk';
            }
            
            if (/^[–ê–í–ï–ö–ú–ù–û–†–°–¢–£–•]\d{3}[–ê–í–ï–ö–ú–ù–û–†–°–¢–£–•]{2}\d{2,3}$/i.test(cleanQuery)) {
                return 'auto';
            }
            
            if (/^(?:\d{1,3}\.){3}\d{1,3}$/.test(cleanQuery)) {
                return 'ip';
            }
            
            if (/^\d{3}-\d{3}-\d{3}\s?\d{2}$/.test(cleanQuery)) {
                return 'snils';
            }
            
            if (/^\d{10,12}$/.test(cleanQuery)) {
                return 'inn';
            }

            if (/^\d{4}\s?\d{6}$/.test(cleanQuery)) {
                return 'passport';
            }

            if (/[–ê-–Ø–∞-—è]+\s*[–ê-–Ø–∞-—è]+,\s*[–ê-–Ø–∞-—è]+/.test(cleanQuery)) {
                return 'address';
            }

            if (/^[A-HJ-NPR-Z0-9]{17}$/i.test(cleanQuery)) {
                return 'vin';
            }
            
            if (/^[–ê-–Ø–Å][–∞-—è—ë]+\s+[–ê-–Ø–Å][–∞-—è—ë]+(\s+[–ê-–Ø–Å][–∞-—è—ë]+)?$/.test(cleanQuery)) {
                return 'fio';
            }
            
            return 'nick';
        }

        function renderAtlasData(data, settings) {
            if (data.error) {
                logAction(`API_ERROR_RESPONSE`, { error: data.error, example: data.example }, 'error');
                return `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <span style="font-weight: bold; font-size: 1.1rem;">ATLAS API</span>
                        <span class="status" style="color: #F44336;">–û–®–ò–ë–ö–ê</span>
                    </div>
                    <div class="result-data">
                        <div style="color: #FFC107; text-align: center; padding: 20px;">
                            <strong>–û—à–∏–±–∫–∞:</strong> ${data.error}
                            ${data.example ? `<br><br><strong>–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:</strong><br><code>${JSON.stringify(data.example, null, 2)}</code>` : ''}
                        </div>
                    </div>
                `;
            }

            if (data.result === "not found or error") {
                logAction(`API_NO_RESULTS`, { query: settings.query, type: settings.searchType }, 'info');
                return `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <span style="font-weight: bold; font-size: 1.1rem;">ATLAS API</span>
                        <span class="status" style="color: #FFC107;">–ù–ï –ù–ê–ô–î–ï–ù–û</span>
                    </div>
                    <div class="result-data">
                        <div style="color: #aaa; text-align: center; padding: 20px;">
                            –ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
                        </div>
                    </div>
                `;
            }

            let html = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="font-weight: bold; font-size: 1.1rem;">ATLAS API</span>
                    <span class="status" style="color: #4CAF50;">–£–°–ü–ï–•</span>
                </div>
                <div class="result-data">
                    <div class="info-line">
                        <span class="info-label">–ú–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞:</span>
                        <span class="info-value">${settings.method.toUpperCase()} (${getMethodSize(settings.method)})</span>
                    </div>
                    <div class="info-line">
                        <span class="info-label">–ì–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞:</span>
                        <span class="info-value">${getDepthName(settings.depth)}</span>
                    </div>
            `;

            if (data.result && typeof data.result === 'object') {
                const resultCount = Object.keys(data.result).length;
                html += `
                    <div class="info-line">
                        <span class="info-label">–ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π:</span>
                        <span class="info-value">${resultCount}</span>
                    </div>
                `;
                
                html += `<div class="section-title">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</div>`;
                html += `<div class="json-container">`;
                
                for (const [key, value] of Object.entries(data.result)) {
                    const formattedValue = formatJsonValue(key, value);
                    if (formattedValue) {
                        html += `
                            <div class="json-item ${getItemClass(key)}">
                                <div class="json-field">
                                    <span class="json-key">${formatKey(key)}:</span>
                                    <span class="json-value">${formattedValue}</span>
                                </div>
                            </div>
                        `;
                    }
                }
                
                html += `</div>`;
            }

            html += `</div>`;
            return html;
        }

        function getMethodSize(method) {
            const sizes = {
                'lite': '40–¢–ë',
                'pro': '100–¢–ë', 
                'full': '200–¢–ë',
                'ultimate': '500–¢–ë'
            };
            return sizes[method] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
        }

        function getDepthName(depth) {
            const names = {
                'basic': '–ë–∞–∑–æ–≤–∞—è',
                'extended': '–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è',
                'deep': '–ì–ª—É–±–æ–∫–∞—è',
                'maximum': '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è'
            };
            return names[depth] || depth;
        }

        function getItemClass(key) {
            const keyLower = key.toLowerCase();
            if (keyLower.includes('leak') || keyLower.includes('breach') || keyLower.includes('password')) 
                return 'leak-item';
            if (keyLower.includes('social') || keyLower.includes('contact') || keyLower.includes('friend')) 
                return 'social-item';
            if (keyLower.includes('financial') || keyLower.includes('bank') || keyLower.includes('card')) 
                return 'finance-item';
            if (keyLower.includes('personal') || keyLower.includes('passport') || keyLower.includes('address'))
                return 'personal-item';
            if (keyLower.includes('technical') || keyLower.includes('ip') || keyLower.includes('device'))
                return 'technical-item';
            return '';
        }

        function formatJsonValue(key, value) {
            if (value === null || value === undefined || value === '') return null;
            
            if (typeof value === 'boolean') {
                return value ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç';
            }
            
            if (typeof value === 'number') {
                return key.toLowerCase().includes('sum') ? `${value.toLocaleString()} ‚ÇΩ` : 
                       key.toLowerCase().includes('id') ? `#${value}` : value.toLocaleString();
            }
            
            if (typeof value === 'string') {
                if (value.length > 150) {
                    return value.substring(0, 150) + '...';
                }
                
                if (value === 'ACTIVE' || value === 'Y' || value === 'true') return '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω';
                if (value === 'INACTIVE' || value === 'N' || value === 'false') return '‚ùå –ù–µ–∞–∫—Ç–∏–≤–µ–Ω';
                if (value === 'NULL' || value === 'null') return '‚Äî';
                
                if (value.startsWith('http')) {
                    return `<a href="${value}" target="_blank" style="color: #4CAF50;">${value}</a>`;
                }
                
                return value;
            }
            
            if (typeof value === 'object') {
                if (Array.isArray(value)) {
                    return value.slice(0, 5).map(item => 
                        typeof item === 'object' ? JSON.stringify(item) : String(item)
                    ).join(', ') + (value.length > 5 ? `... (+${value.length - 5})` : '');
                }
                return JSON.stringify(value, null, 2);
            }
            
            return String(value);
        }

        function formatKey(key) {
            const formatted = key.replace(/\./g, ' ')
                               .replace(/([A-Z])/g, ' $1')
                               .replace(/_/g, ' ')
                               .replace(/\b\w/g, l => l.toUpperCase())
                               .trim();
            
            return formatted;
        }

        function clearResults() {
            const resultsDiv = document.getElementById('results');
            const totalResultDiv = document.getElementById('totalResult');
            const progressBar = document.getElementById('progressBar');
            const apiCounter = document.getElementById('apiCounter');
            
            resultsDiv.innerHTML = '';
            totalResultDiv.style.display = 'none';
            progressBar.style.width = '0%';
            apiCounter.textContent = '';
        }

        async function validateInput() {
            if (currentSearchInProgress) return;
            
            const input = document.getElementById('searchInput');
            const query = input.value.trim();
            
            if (!query) {
                alert('–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞');
                return;
            }

            await logAction(`VALIDATION_STARTED`, { query: query }, 'info');
            clearResults();
            setButtonsState(true);
            currentSearchInProgress = true;

            const searchType = detectSearchType(query);
            let validCount = 0;
            let totalChecked = 0;
            
            const checks = getValidationChecks(query, searchType);
            const totalChecks = checks.length;
            
            for (let i = 0; i < checks.length; i++) {
                if (!currentSearchInProgress) break;
                
                const check = checks[i];
                const resultsDiv = document.getElementById('results');
                const progressBar = document.getElementById('progressBar');
                const apiCounter = document.getElementById('apiCounter');
                
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item checking';
                resultItem.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span>${check.name} <span class="service-name">–ø—Ä–æ–≤–µ—Ä–∫–∞...</span></span>
                        <span class="status">...</span>
                    </div>
                `;
                resultsDiv.appendChild(resultItem);
                
                progressBar.style.width = `${((i + 1) / totalChecks) * 100}%`;
                apiCounter.textContent = `–ü—Ä–æ–≤–µ—Ä–∫–∞ ${i + 1} –∏–∑ ${totalChecks}`;
                
                await new Promise(resolve => setTimeout(resolve, 300));
                
                try {
                    const isValid = check.check();
                    totalChecked++;
                    
                    if (isValid) {
                        validCount++;
                        resultItem.className = 'result-item valid';
                        resultItem.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>${check.name} <span class="service-name">‚úì –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</span></span>
                                <span class="status">–í–ê–õ–ò–î</span>
                            </div>
                            ${check.details ? `<div style="margin-top: 8px; font-size: 0.9rem; color: #ccc;">${check.details}</div>` : ''}
                        `;
                    } else {
                        resultItem.className = 'result-item invalid';
                        resultItem.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>${check.name} <span class="service-name">‚úì –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</span></span>
                                <span class="status">–ù–ï –í–ê–õ–ò–î</span>
                            </div>
                            ${check.details ? `<div style="margin-top: 8px; font-size: 0.9rem; color: #ccc;">${check.details}</div>` : ''}
                        `;
                    }
                } catch (error) {
                    await logError(error, `VALIDATION_CHECK_${check.name}`);
                    resultItem.className = 'result-item error';
                    resultItem.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>${check.name} <span class="service-name">‚úó –æ—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏</span></span>
                            <span class="status">–û–®–ò–ë–ö–ê</span>
                        </div>
                    `;
                }
            }
            
            if (totalChecked > 0 && currentSearchInProgress) {
                const validPercentage = (validCount / totalChecked) * 100;
                const totalResultDiv = document.getElementById('totalResult');
                totalResultDiv.style.display = 'block';
                
                if (validPercentage >= 60) {
                    totalResultDiv.className = 'total-result total-valid';
                    totalResultDiv.textContent = `–û–ë–©–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢: –í–ê–õ–ò–î (${validCount}/${totalChecked} –ø—Ä–æ–≤–µ—Ä–æ–∫)`;
                } else {
                    totalResultDiv.className = 'total-result total-invalid';
                    totalResultDiv.textContent = `–û–ë–©–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢: –ù–ï –í–ê–õ–ò–î (${validCount}/${totalChecked} –ø—Ä–æ–≤–µ—Ä–æ–∫)`;
                }
                
                totalResultDiv.scrollIntoView({ behavior: 'smooth' });
            }
            
            await logAction(`VALIDATION_COMPLETED`, { 
                query: query, 
                type: searchType, 
                validCount: validCount, 
                totalChecked: totalChecked, 
                validPercentage: Math.round(validPercentage) 
            }, 'info');
            
            setButtonsState(false);
            currentSearchInProgress = false;
            document.getElementById('progressBar').style.width = '100%';
            document.getElementById('apiCounter').textContent = '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞';
        }

        function getValidationChecks(query, type) {
            const checks = [];
            
            checks.push(
                { 
                    name: "–î–ª–∏–Ω–∞ –¥–∞–Ω–Ω—ã—Ö", 
                    check: () => query.length >= 2 && query.length <= 255,
                    details: `–î–ª–∏–Ω–∞: ${query.length} —Å–∏–º–≤–æ–ª–æ–≤`
                },
                { 
                    name: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞", 
                    check: () => !/[<>\"']/.test(query),
                    details: "–ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç"
                }
            );
            
            switch(type) {
                case 'phone':
                    const cleanPhone = query.replace(/\D/g, '');
                    checks.push(
                        { 
                            name: "–§–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞", 
                            check: () => /^[78]?\d{10}$/.test(cleanPhone),
                            details: `–ß–∏—Å—Ç—ã–π –Ω–æ–º–µ—Ä: ${cleanPhone}`
                        },
                        { 
                            name: "–ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã", 
                            check: () => cleanPhone.startsWith('7') || cleanPhone.startsWith('8'),
                            details: "–†–æ—Å—Å–∏–π—Å–∫–∏–π –Ω–æ–º–µ—Ä"
                        },
                        { 
                            name: "–ö–æ–¥ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞", 
                            check: () => {
                                const operatorCode = cleanPhone.substring(1, 4);
                                const validCodes = ['910', '915', '916', '917', '919', '985', '986', '903', '905', '906', '999', '995', '901'];
                                return validCodes.includes(operatorCode);
                            },
                            details: "–í–∞–ª–∏–¥–Ω—ã–π –∫–æ–¥ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞"
                        }
                    );
                    break;
                    
                case 'email':
                    const [local, domain] = query.split('@');
                    checks.push(
                        { 
                            name: "–§–æ—Ä–º–∞—Ç email", 
                            check: () => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(query),
                            details: `–õ–æ–∫–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å: ${local}, –î–æ–º–µ–Ω: ${domain}`
                        },
                        { 
                            name: "–î–ª–∏–Ω–∞ email", 
                            check: () => query.length <= 254,
                            details: "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º"
                        },
                        { 
                            name: "–í–∞–ª–∏–¥–Ω–æ—Å—Ç—å –¥–æ–º–µ–Ω–∞", 
                            check: () => domain.includes('.') && domain.length >= 4,
                            details: "–î–æ–º–µ–Ω –≤–∞–ª–∏–¥–µ–Ω"
                        }
                    );
                    break;
                    
                case 'fio':
                    const nameParts = query.split(' ').filter(part => part.length > 1);
                    checks.push(
                        { 
                            name: "–§–æ—Ä–º–∞—Ç –§–ò–û", 
                            check: () => nameParts.length >= 2,
                            details: `–ß–∞—Å—Ç–µ–π: ${nameParts.length}`
                        },
                        { 
                            name: "–ö–∏—Ä–∏–ª–ª–∏—Ü–∞", 
                            check: () => /^[–∞-—è—ë\s-]+$/i.test(query),
                            details: "–¢–æ–ª—å–∫–æ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã"
                        },
                        { 
                            name: "–†–µ–≥–∏—Å—Ç—Ä –±—É–∫–≤", 
                            check: () => /^[–ê-–Ø–Å][–∞-—è—ë]/.test(nameParts[0]),
                            details: "–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä"
                        }
                    );
                    break;
                    
                case 'vk':
                    checks.push(
                        { 
                            name: "–§–æ—Ä–º–∞—Ç VK", 
                            check: () => /^(id\d+|vk\.com\/[a-zA-Z0-9_.]+)$/.test(query) || query.includes('vk.com'),
                            details: "–í–∞–ª–∏–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç VK"
                        }
                    );
                    break;
                    
                case 'auto':
                    checks.push(
                        { 
                            name: "–†–æ—Å—Å–∏–π—Å–∫–∏–π –Ω–æ–º–µ—Ä", 
                            check: () => /^[–ê–í–ï–ö–ú–ù–û–†–°–¢–£–•]\d{3}[–ê–í–ï–ö–ú–ù–û–†–°–¢–£–•]{2}\d{2,3}$/i.test(query),
                            details: "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ì–û–°–¢—É"
                        }
                    );
                    break;
                    
                case 'ip':
                    checks.push(
                        { 
                            name: "–§–æ—Ä–º–∞—Ç IP", 
                            check: () => /^(?:\d{1,3}\.){3}\d{1,3}$/.test(query),
                            details: "–í–∞–ª–∏–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç IPv4"
                        },
                        { 
                            name: "–í–∞–ª–∏–¥–Ω—ã–µ –æ–∫—Ç–µ—Ç—ã", 
                            check: () => {
                                const octets = query.split('.');
                                return octets.every(octet => {
                                    const num = parseInt(octet);
                                    return num >= 0 && num <= 255;
                                });
                            },
                            details: "–í—Å–µ –æ–∫—Ç–µ—Ç—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0-255"
                        }
                    );
                    break;

                case 'passport':
                    checks.push(
                        { 
                            name: "–§–æ—Ä–º–∞—Ç –ø–∞—Å–ø–æ—Ä—Ç–∞", 
                            check: () => /^\d{4}\s?\d{6}$/.test(query),
                            details: "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç—É –†–§"
                        }
                    );
                    break;

                case 'vin':
                    checks.push(
                        { 
                            name: "–§–æ—Ä–º–∞—Ç VIN", 
                            check: () => /^[A-HJ-NPR-Z0-9]{17}$/i.test(query),
                            details: "–í–∞–ª–∏–¥–Ω—ã–π VIN –Ω–æ–º–µ—Ä"
                        }
                    );
                    break;
                    
                default:
                    checks.push(
                        { 
                            name: "–û–±—â–∞—è –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å", 
                            check: () => query.length >= 2 && query.length <= 255,
                            details: "–î–∞–Ω–Ω—ã–µ –ø—Ä–æ—à–ª–∏ –±–∞–∑–æ–≤—É—é –ø—Ä–æ–≤–µ—Ä–∫—É"
                        }
                    );
            }
            
            return checks;
        }

        async function searchByAPI() {
            if (currentSearchInProgress) return;
            
            const input = document.getElementById('searchInput');
            const query = input.value.trim();
            
            if (!query) {
                alert('–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞');
                return;
            }
            
            await logAction(`API_SEARCH_STARTED`, { query: query, type: currentSearchType }, 'info');
            clearResults();
            setButtonsState(true);
            currentSearchInProgress = true;

            const resultsDiv = document.getElementById('results');
            const progressBar = document.getElementById('progressBar');
            const apiCounter = document.getElementById('apiCounter');
            
            const loadingItem = document.createElement('div');
            loadingItem.className = 'result-item checking';
            loadingItem.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ATLAS API <span class="service-name">–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...</span></span>
                    <span class="status">...</span>
                </div>
            `;
            resultsDiv.appendChild(loadingItem);
            
            try {
                progressBar.style.width = '30%';
                apiCounter.textContent = '–ó–∞–ø—Ä–æ—Å –∫ ATLAS API...';
                
                const settings = {
                    searchType: document.getElementById('searchType').value === 'auto' ? 
                               detectSearchType(query) : document.getElementById('searchType').value,
                    method: document.getElementById('searchMethod').value,
                    depth: document.getElementById('searchDepth').value,
                    sources: Array.from(document.getElementById('dataSources').selectedOptions).map(opt => opt.value),
                    limit: parseInt(document.getElementById('resultLimit').value),
                    timeout: parseInt(document.getElementById('timeout').value),
                    format: document.getElementById('outputFormat').value,
                    query: query
                };
                
                const timeoutPromise = new Promise((_, reject) => 
                    setTimeout(() => reject(new Error('–¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞: —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç')), settings.timeout * 1000)
                );
                
                const searchPromise = searchAtlasAPI(query, settings);
                const data = await Promise.race([searchPromise, timeoutPromise]);
                
                progressBar.style.width = '100%';
                apiCounter.textContent = '–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã';
                
                if (currentSearchInProgress) {
                    loadingItem.className = 'api-result';
                    loadingItem.innerHTML = renderAtlasData(data, settings);
                }
                
            } catch (error) {
                await logError(error, 'API_SEARCH_EXECUTION');
                if (currentSearchInProgress) {
                    loadingItem.className = 'result-item error';
                    loadingItem.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>ATLAS API <span class="service-name">‚úó –æ—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</span></span>
                            <span class="status">–û–®–ò–ë–ö–ê</span>
                        </div>
                        <div style="margin-top: 10px; color: #FFC107; font-size: 0.9rem;">
                            ${error.message}
                        </div>
                    `;
                }
            }
            
            setButtonsState(false);
            currentSearchInProgress = false;
        }

        async function deepSearch() {
            await searchByAPI();
        }

        function setButtonsState(disabled) {
            const searchBtn = document.getElementById('searchBtn');
            searchBtn.disabled = disabled;
            searchBtn.textContent = disabled ? '–ü–û–ò–°–ö...' : '–ù–ê–ß–ê–¢–¨ –ü–û–ò–°–ö';
        }

        document.addEventListener('DOMContentLoaded', async () => {
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
            }, 2000);

            try {
                await logAction('APPLICATION_LOADED', { 
                    url: window.location.href,
                    userAgent: navigator.userAgent,
                    screenResolution: `${screen.width}x${screen.height}`,
                    language: navigator.language
                }, 'info');
                
                document.querySelectorAll('.search-type-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        currentSearchInProgress = false;
                        
                        document.querySelectorAll('.search-type-btn').forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        currentSearchType = this.getAttribute('data-type');
                        
                        const settingsPanel = document.getElementById('apiSettings');
                        if (currentSearchType === 'api' || currentSearchType === 'deep') {
                            settingsPanel.classList.add('active');
                        } else {
                            settingsPanel.classList.remove('active');
                        }
                        
                        clearResults();
                    });
                });
                
                document.getElementById('searchBtn').addEventListener('click', function() {
                    switch(currentSearchType) {
                        case 'validity': validateInput(); break;
                        case 'api': searchByAPI(); break;
                        case 'deep': deepSearch(); break;
                    }
                });
                
                document.getElementById('searchInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') document.getElementById('searchBtn').click();
                });
                
                document.querySelectorAll('.example-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.getElementById('searchInput').value = this.getAttribute('data-example');
                    });
                });
                
                document.getElementById('searchInput').value = '+79161234567';
                
                window.addEventListener('error', function(event) {
                    logError(event.error, 'WINDOW_ERROR');
                });
                
                window.addEventListener('unhandledrejection', function(event) {
                    logError(new Error(`Unhandled Promise Rejection: ${event.reason}`), 'PROMISE_REJECTION');
                });
                
            } catch (error) {
                await logError(error, 'APPLICATION_INITIALIZATION');
                console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: ' + error.message);
                document.getElementById('loader').style.display = 'none';
            }
        });
    </script>
</body>
</html>